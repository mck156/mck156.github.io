```python
# 原来的代码
target_mean = train[train['dt'] <= 20].groupby(['id'])['target'].mean().reset_index()

train['dt'] <= 20 # 筛选训练集中dt列值<=20的值
.groupby(['id']) # 按照id列对筛选后的数据分组
['target'] # 关注target列
.mean() # 计算每个分组中target列的平均值
.rest_index() # 重置索引 将分组后的结果转化为普通的DataFrame格式 id是一列
```